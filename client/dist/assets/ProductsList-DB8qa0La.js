import{r as c,u as C,j as e,A,b as m,_}from"./index-R32pK0TL.js";const T=()=>{const[n,u]=c.useState([]),[d,g]=c.useState(1),[o,p]=c.useState(""),[i,y]=c.useState({}),l=4,[r,b]=c.useState(new Set),j=C(),x=n.filter(s=>s.name.toLowerCase().includes(o.toLowerCase())),h=d*l,f=h-l,N=x.slice(f,h),v=s=>g(s);c.useEffect(()=>{(async()=>{try{const a=await(await fetch(`${m}/product`,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"})).json();u(a.products)}catch(t){console.log(t)}})()},[]);const w=s=>{const t=new Set(r);t.has(s)?t.delete(s):t.add(s),b(t)},P=(s,t)=>{y(a=>({...a,[s]:t}))},S=async()=>{const t={products:Array.from(r).map(a=>({productId:a,quantity:i[a]||1})),tax:5};try{(await(await fetch(`${m}/sub-sales/add`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),credentials:"include"})).json()).success&&(_.success("Sale added successfully"),j("/new-sale"))}catch(a){console.log("Error adding products to sale",a)}};return e.jsx(A,{children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-700 mb-6",children:"Product List"}),e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search by product name...",value:o,onChange:s=>p(s.target.value),className:"border border-gray-300 rounded-lg p-2 w-full"})}),e.jsx("div",{className:"bg-white p-6 shadow-lg rounded-lg",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full bg-white border border-gray-300 rounded-lg",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-100 border-b",children:[e.jsx("th",{className:"px-4 py-3 text-left text-gray-600 font-semibold",children:"Select"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-600 font-semibold",children:"Image"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-600 font-semibold",children:"Product Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-600 font-semibold",children:"Price"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-600 font-semibold",children:"Stock"})]})}),e.jsx("tbody",{children:N.map(s=>e.jsxs("tr",{className:"border-b hover:bg-gray-50 transition",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{type:"checkbox",checked:r.has(s._id),onChange:()=>w(s._id),className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("img",{src:s.image,alt:s.name,className:"h-16 w-16 object-cover rounded"})}),e.jsx("td",{className:"px-4 py-3 text-gray-700 font-medium",children:s.name}),e.jsxs("td",{className:"px-4 py-3 text-gray-700",children:["₹ ",s.price]}),e.jsx("td",{className:"px-4 py-3 text-gray-500",children:s.stock})]},s._id))})]})})}),r.size>0&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-700 mb-4",children:"Selected Products"}),e.jsx("div",{className:"space-y-4",children:Array.from(r).map(s=>{const t=n.find(a=>a._id===s);return e.jsxs("div",{className:"flex items-center space-x-4 border p-4 rounded-lg",children:[e.jsxs("div",{className:"w-1/3",children:[e.jsx("img",{src:t.image,alt:t.name,className:"h-16 w-16 object-cover rounded"}),e.jsx("p",{className:"text-gray-700 font-medium",children:t.name})]}),e.jsx("div",{className:"w-1/3",children:e.jsxs("p",{children:["₹ ",t.price]})}),e.jsx("div",{className:"w-1/3",children:e.jsx("input",{type:"number",min:"1",value:i[s]||1,onChange:a=>P(s,a.target.value),className:"border border-gray-300 rounded-lg p-2 w-full"})})]},s)})})]}),e.jsx("div",{className:"flex justify-between mt-4",children:e.jsx("button",{onClick:S,disabled:r.size===0,className:`px-4 py-2 font-semibold text-white rounded-lg ${r.size===0?"bg-gray-300":"bg-blue-600 hover:bg-blue-700"} transition`,children:"continue"})}),e.jsx("div",{className:"flex justify-center mt-4",children:e.jsx("nav",{children:e.jsx("ul",{className:"flex space-x-2",children:Array.from({length:Math.ceil(x.length/l)},(s,t)=>e.jsx("li",{children:e.jsx("button",{onClick:()=>v(t+1),className:`px-3 py-1 rounded-md ${d===t+1?"bg-blue-600 text-white":"bg-gray-200 text-gray-700"} hover:bg-blue-700 hover:text-white transition`,children:t+1})},t))})})})]})})};export{T as default};
